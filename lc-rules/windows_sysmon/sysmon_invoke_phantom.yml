detect:
  log type: wel
  op: and
  rules:
  - case sensitive: false
    op: is
    path: Event/System/EventID
    value: '10'
  - case sensitive: false
    op: ends with
    path: Event/EventData/TargetImage
    value: \windows\system32\svchost.exe
  - case sensitive: false
    op: is
    path: Event/EventData/GrantedAccess
    value: '0x1f3fff'
  - case sensitive: false
    op: contains
    path: Event/EventData/CallTrace
    value: unknown
  target: log
respond:
- action: report
  metadata:
    author: Tim Burrell
    description: Detects suspect access to svchost process memory such as that used
      by Invoke-Phantom to kill the winRM windows event logging service.
    falsepositives:
    - unknown
    level: high
    references:
    - https://github.com/hlldz/Invoke-Phant0m
    - https://twitter.com/timbmsft/status/900724491076214784
    tags:
    - attack.t1089
    - attack.defense_evasion
    - attack.t1562.001
  name: Suspect Svchost Memory Asccess

