detect:
  events: [NEW_PROCESS, EXISTING_PROCESS]
  op: and
  rules:
  - {op: is windows}
  - op: and
    rules:
    - {case sensitive: false, op: ends with, path: event/FILE_PATH, value: \OpenWith.exe}
    - {case sensitive: false, op: contains, path: event/COMMAND_LINE, value: /c}
respond:
- action: report
  metadata:
    author: Beyu Denis, oscd.community (rule), @harr0ey (idea)
    description: The OpenWith.exe executes other binary
    level: high
    references: ['https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Openwith.yml',
      'https://twitter.com/harr0ey/status/991670870384021504']
    tags: [attack.defense_evasion, attack.execution, attack.t1218]
  name: OpenWith.exe executes specified binary

