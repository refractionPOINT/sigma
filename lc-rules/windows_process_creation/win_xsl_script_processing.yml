detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - op: or
    rules:
    - op: and
      rules:
      - case sensitive: false
        op: ends with
        path: event/FILE_PATH
        value: \wmic.exe
      - case sensitive: false
        op: contains
        path: event/COMMAND_LINE
        value: /format
    - case sensitive: false
      op: ends with
      path: event/FILE_PATH
      value: \msxsl.exe
respond:
- action: report
  metadata:
    author: Timur Zinniatullin, oscd.community
    description: Extensible Stylesheet Language (XSL) files are commonly used to describe
      the processing and rendering of data within XML files, rule detects when adversaries
      abuse this functionality to execute arbitrary files while potentially bypassing
      application whitelisting defenses
    falsepositives:
    - WMIC.exe FP depend on scripts and administrative methods used in the monitored
      environment
    - msxsl.exe is not installed by default so unlikely.
    level: medium
    references:
    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1220/T1220.yaml
    tags:
    - attack.execution
    - attack.t1220
  name: XSL Script Processing

