detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: contains
    path: event/COMMAND_LINE
    value: ::FromBase64String(
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects suspicious FromBase64String expressions in command line arguments
    falsepositives:
    - Administrative script libraries
    level: high
    references:
    - https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639
    tags:
    - attack.t1027
    - attack.defense_evasion
  name: FromBase64String Command Line

