detect:
  events:
  - NEW_PROCESS
  - EXISTING_PROCESS
  op: and
  rules:
  - op: is windows
  - case sensitive: false
    op: ends with
    path: event/PARENT/FILE_PATH
    value: \EQNEDT32.EXE
respond:
- action: report
  metadata:
    author: Florian Roth
    description: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and
      other sub processes like mshta.exe
    falsepositives:
    - unknown
    level: critical
    references:
    - https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100
    - https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw
    tags:
    - attack.execution
    - attack.t1203
    - attack.t1204.002
    - attack.t1204
    - attack.initial_access
    - attack.t1566.001
    - attack.t1193
  name: Droppers Exploiting CVE-2017-11882

